nw_b[3, 7] <- 0
}
if(type == "degree2"){
m <- matrix(0, 8, 8)
m[1, 2] <-  m[2, 3]<-  m[2, 4]<- m[2, 5] <-
m[3, 6]<- m[5, 6]<-  m[6, 7]<-  m[7, 8]<-  1
}
if(type == "close"){
nw <- matrix(0, 7, 7)
nw[1, 2] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[3, 7] <- 0
nw_b <- nw
nw_b[2, 6] <- 0
}
if(type == "close2"){
nw <- matrix(0, 7, 7)
nw[2, 5] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[3, 7] <- 0
nw_b <- nw
nw_b[2, 6] <- 0
}
if(type == "between"){
nw <- matrix(0, 7, 7)
nw[1, 5] <- nw[2, 3] <-
nw[2, 6] <- nw[2, 7] <-
nw[3, 7] <- nw[4, 5] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[2, 7] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(type == "between2"){
nw <- matrix(0, 8, 8)
nw[1, 5] <- nw[2, 3] <-
nw[2, 6] <- nw[2, 7] <-
nw[3, 7] <- nw[4, 8] <-
nw[5, 6] <- nw[6, 7] <-
nw[7, 8] <- 1
nw_a <- nw
nw_a[2, 6] <- 0
nw_b <- nw
nw_b[7, 8] <- 0
}
if(type == "alt"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4]  <-
nw[2, 3]<- nw[2, 5] <-
nw[3, 5] <- nw[3, 6]  <-
nw[4, 5]  <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 2] <- 0
nw_b <- nw
nw_b[3, 6] <- 0
}
if(type == "alt2"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4] <- nw[1, 5]  <-
nw[2, 3] <- nw[2, 5] <-
nw[2, 6] <- nw[3, 5] <-
nw[3, 6] <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 2] <- 0
nw_b <- nw
nw_b[2, 3] <- 0
}
if(type == "alt3"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4] <- nw[1, 5]  <-
nw[2, 3] <- nw[2, 5] <-
nw[2, 6] <- nw[3, 5] <-
nw[3, 6] <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 5] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(half == FALSE){
nw[lower.tri(nw)] <- t(nw)[lower.tri(nw)]
nw_a[lower.tri(nw_a)] <- t(nw_a)[lower.tri(nw_a)]
nw_b[lower.tri(nw_b)] <- t(nw_b)[lower.tri(nw_b)]
}
nwmodels <- list(full = nw,
a = nw_a,
b = nw_b)
return(nwmodels)
}
degree <- getnw("degree2")
getnw <- function(type, half = FALSE){
if(type == "degree"){
nw <- matrix(0, 8, 8)
nw[1, 2] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <-
nw[2, 7] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <-
nw[7, 8] <- 1
nw_a <- nw
nw_a[2, 6] <- 0
nw_b <- nw
nw_b[3, 7] <- 0
}
if(type == "degree2"){
nw <- matrix(0, 8, 8)
nw[1, 2] <-  nw[2, 3]<-  nw[2, 4]<- nw[2, 5] <-
nw[3, 6]<- nw[5, 6]<-  nw[6, 7]<-  nw[7, 8]<-  1
}
if(type == "close"){
nw <- matrix(0, 7, 7)
nw[1, 2] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[3, 7] <- 0
nw_b <- nw
nw_b[2, 6] <- 0
}
if(type == "close2"){
nw <- matrix(0, 7, 7)
nw[2, 5] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[3, 7] <- 0
nw_b <- nw
nw_b[2, 6] <- 0
}
if(type == "between"){
nw <- matrix(0, 7, 7)
nw[1, 5] <- nw[2, 3] <-
nw[2, 6] <- nw[2, 7] <-
nw[3, 7] <- nw[4, 5] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[2, 7] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(type == "between2"){
nw <- matrix(0, 8, 8)
nw[1, 5] <- nw[2, 3] <-
nw[2, 6] <- nw[2, 7] <-
nw[3, 7] <- nw[4, 8] <-
nw[5, 6] <- nw[6, 7] <-
nw[7, 8] <- 1
nw_a <- nw
nw_a[2, 6] <- 0
nw_b <- nw
nw_b[7, 8] <- 0
}
if(type == "alt"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4]  <-
nw[2, 3]<- nw[2, 5] <-
nw[3, 5] <- nw[3, 6]  <-
nw[4, 5]  <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 2] <- 0
nw_b <- nw
nw_b[3, 6] <- 0
}
if(type == "alt2"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4] <- nw[1, 5]  <-
nw[2, 3] <- nw[2, 5] <-
nw[2, 6] <- nw[3, 5] <-
nw[3, 6] <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 2] <- 0
nw_b <- nw
nw_b[2, 3] <- 0
}
if(type == "alt3"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4] <- nw[1, 5]  <-
nw[2, 3] <- nw[2, 5] <-
nw[2, 6] <- nw[3, 5] <-
nw[3, 6] <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 5] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(half == FALSE){
nw[lower.tri(nw)] <- t(nw)[lower.tri(nw)]
nw_a[lower.tri(nw_a)] <- t(nw_a)[lower.tri(nw_a)]
nw_b[lower.tri(nw_b)] <- t(nw_b)[lower.tri(nw_b)]
}
nwmodels <- list(full = nw,
a = nw_a,
b = nw_b)
return(nwmodels)
}
degree <- getnw("degree2")
getnw <- function(type, half = FALSE){
if(type == "degree"){
nw <- matrix(0, 8, 8)
nw[1, 2] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <-
nw[2, 7] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <-
nw[7, 8] <- 1
nw_a <- nw
nw_a[2, 6] <- 0
nw_b <- nw
nw_b[3, 7] <- 0
}
if(type == "degree2"){
nw <- matrix(0, 8, 8)
nw[1, 2] <-  nw[2, 3]<-  nw[2, 4]<- nw[2, 5] <-
nw[3, 6]<- nw[5, 6]<-  nw[6, 7]<-  nw[7, 8]<-  1
nw_a <- nw
nw_a[2, 5] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(type == "close"){
nw <- matrix(0, 7, 7)
nw[1, 2] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[3, 7] <- 0
nw_b <- nw
nw_b[2, 6] <- 0
}
if(type == "close2"){
nw <- matrix(0, 7, 7)
nw[2, 5] <- nw[1, 5] <-
nw[2, 3] <- nw[2, 6] <- nw[3, 4] <-
nw[3, 7] <- nw[4, 7] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[3, 7] <- 0
nw_b <- nw
nw_b[2, 6] <- 0
}
if(type == "between"){
nw <- matrix(0, 7, 7)
nw[1, 5] <- nw[2, 3] <-
nw[2, 6] <- nw[2, 7] <-
nw[3, 7] <- nw[4, 5] <-
nw[5, 6] <- nw[6, 7] <- 1
nw_a <- nw
nw_a[2, 7] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(type == "between2"){
nw <- matrix(0, 8, 8)
nw[1, 5] <- nw[2, 3] <-
nw[2, 6] <- nw[2, 7] <-
nw[3, 7] <- nw[4, 8] <-
nw[5, 6] <- nw[6, 7] <-
nw[7, 8] <- 1
nw_a <- nw
nw_a[2, 6] <- 0
nw_b <- nw
nw_b[7, 8] <- 0
}
if(type == "alt"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4]  <-
nw[2, 3]<- nw[2, 5] <-
nw[3, 5] <- nw[3, 6]  <-
nw[4, 5]  <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 2] <- 0
nw_b <- nw
nw_b[3, 6] <- 0
}
if(type == "alt2"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4] <- nw[1, 5]  <-
nw[2, 3] <- nw[2, 5] <-
nw[2, 6] <- nw[3, 5] <-
nw[3, 6] <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 2] <- 0
nw_b <- nw
nw_b[2, 3] <- 0
}
if(type == "alt3"){
nw <- matrix(0,6,6)
nw[1, 2] <- nw[1, 4] <- nw[1, 5]  <-
nw[2, 3] <- nw[2, 5] <-
nw[2, 6] <- nw[3, 5] <-
nw[3, 6] <- nw[5, 6]  <- 1
nw_a <- nw
nw_a[1, 5] <- 0
nw_b <- nw
nw_b[5, 6] <- 0
}
if(half == FALSE){
nw[lower.tri(nw)] <- t(nw)[lower.tri(nw)]
nw_a[lower.tri(nw_a)] <- t(nw_a)[lower.tri(nw_a)]
nw_b[lower.tri(nw_b)] <- t(nw_b)[lower.tri(nw_b)]
}
nwmodels <- list(full = nw,
a = nw_a,
b = nw_b)
return(nwmodels)
}
degree2 <- getnw("degree2")
LL_degree2  <- preacher(models = degree2)
plot(ecdf(LL_degree2$full), main="ECDF Random Data Degree", xlab = "LL", ylab="")
lines(ecdf(LL_degree2$a), col = "red")
lines(ecdf(LL_degree2$b), col = "blue")
lines(ecdf(LL_degree2$zero), col = "green")
legend(-1300, .4, legend=c("Model A", "Model B",  "Full Model", "Null Model"),
col = c("red", "blue", "black", "green"), lty = rep(1, 4), box.lty = 0)
pd <- vector()
for(1 in 1:100){
covmat <- crossprod(matrix(runif(8^2, -1,1), 8))
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
}
pd <- vector()
for(i in 1:100){
covmat <- crossprod(matrix(runif(8^2, -1,1), 8))
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
}
sum(pd)
pd <- vector()
for(i in 1:100){
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
}
sum(pd)
pd <- vector()
for(i in 1:1000){
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
}
sum(pd)
pd <- vector()
fit <- vector()
for(i in 1:1000){
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
mod_empty <- ggm(covs = covmat, nobs = 100, covtype = "ML", omega = "empty") %>% runmodel
fit[i] <- fit(mod_empty)[1, 2]
}
sum(pd)
fit
plot(ecdf(fit))
preacher <- function(models, niter = 1000, nobs = 100){
dim <- nrow(models$full)
LLs <- data.frame(full = numeric(),
a = numeric(),
b = numeric(),
zero = numeric())
for(i in 1:niter){
covmat <- crossprod(matrix(runif(dim^2, 0,1), dim))
# cormat <- cov2cor(covmat)
# dat <- mvrnorm(100, rep(0, dim), cormat)
#
# mod_full  <- ggm(data = dat, omega = models$full) %>% runmodel
# mod_a     <- ggm(data = dat, omega = models$a) %>% runmodel
# mod_b     <- ggm(data = dat, omega = models$b) %>% runmodel
mod_full  <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$full) %>% runmodel
mod_a     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$a) %>% runmodel
mod_b     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$b) %>% runmodel
mod_empty <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = "empty") %>% runmodel
LLs[i, "full"]  <- fit(mod_full)[1, 2]
LLs[i, "a"]     <- fit(mod_a)[1, 2]
LLs[i, "b"]     <- fit(mod_b)[1, 2]
LLs[i, "zero"] <- fit(mod_empty)[1, 2]
}
return(LLs)
}
LL_between <- preacher(models = between, niter = 100)
preacher <- function(models, niter = 1000, nobs = 100){
dim <- nrow(models$full)
LLs <- data.frame(full = numeric(),
a = numeric(),
b = numeric(),
zero = numeric())
for(i in 1:niter){
covmat <- crossprod(matrix(runif(dim^2, 0,1), dim))
# cormat <- cov2cor(covmat)
# dat <- mvrnorm(100, rep(0, dim), cormat)
#
# mod_full  <- ggm(data = dat, omega = models$full) %>% runmodel
# mod_a     <- ggm(data = dat, omega = models$a) %>% runmodel
# mod_b     <- ggm(data = dat, omega = models$b) %>% runmodel
# mod_full  <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$full) %>% runmodel
# mod_a     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$a) %>% runmodel
# mod_b     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$b) %>% runmodel
mod_empty <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = "empty") %>% runmodel
LLs[i, "full"]  <- fit(mod_full)[1, 2]
LLs[i, "a"]     <- fit(mod_a)[1, 2]
LLs[i, "b"]     <- fit(mod_b)[1, 2]
LLs[i, "zero"] <- fit(mod_empty)[1, 2]
}
return(LLs)
}
LL_between <- preacher(models = between, niter = 100)
preacher <- function(models, niter = 1000, nobs = 100){
dim <- nrow(models$full)
LLs <- data.frame(full = numeric(),
a = numeric(),
b = numeric(),
zero = numeric())
for(i in 1:niter){
covmat <- crossprod(matrix(runif(dim^2, 0,1), dim))
# cormat <- cov2cor(covmat)
# dat <- mvrnorm(100, rep(0, dim), cormat)
#
# mod_full  <- ggm(data = dat, omega = models$full) %>% runmodel
# mod_a     <- ggm(data = dat, omega = models$a) %>% runmodel
# mod_b     <- ggm(data = dat, omega = models$b) %>% runmodel
# mod_full  <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$full) %>% runmodel
# mod_a     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$a) %>% runmodel
# mod_b     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$b) %>% runmodel
mod_empty <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = "empty") %>% runmodel
# LLs[i, "full"]  <- fit(mod_full)[1, 2]
# LLs[i, "a"]     <- fit(mod_a)[1, 2]
# LLs[i, "b"]     <- fit(mod_b)[1, 2]
LLs[i, "zero"] <- fit(mod_empty)[1, 2]
}
return(LLs)
}
LL_between <- preacher(models = between, niter = 100)
preacher <- function(models, niter = 1000, nobs = 100){
dim <- nrow(models$full)
LLs <- data.frame(full = numeric(),
a = numeric(),
b = numeric(),
zero = numeric())
for(i in 1:niter){
covmat <- crossprod(matrix(runif(dim^2, 0,1), dim))
# cormat <- cov2cor(covmat)
# dat <- mvrnorm(100, rep(0, dim), cormat)
#
# mod_full  <- ggm(data = dat, omega = models$full) %>% runmodel
# mod_a     <- ggm(data = dat, omega = models$a) %>% runmodel
# mod_b     <- ggm(data = dat, omega = models$b) %>% runmodel
mod_full  <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$full) %>% runmodel
# mod_a     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$a) %>% runmodel
# mod_b     <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = models$b) %>% runmodel
mod_empty <- ggm(covs = covmat, nobs = nobs, covtype = "ML", omega = "empty") %>% runmodel
LLs[i, "full"]  <- fit(mod_full)[1, 2]
# LLs[i, "a"]     <- fit(mod_a)[1, 2]
# LLs[i, "b"]     <- fit(mod_b)[1, 2]
LLs[i, "zero"] <- fit(mod_empty)[1, 2]
}
return(LLs)
}
LL_between <- preacher(models = between, niter = 100)
pd <- vector()
fit <- vector()
for(i in 1:1000){
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
mod <- ggm(covs = covmat, nobs = 100, covtype = "ML", omega = between$full) %>% runmodel
fit[i] <- fit(mod)[1, 2]
}
covmat
matrixcalc::is.positive.semi.definite(covmat)
mod <- ggm(covs = covmat, nobs = 100, covtype = "ML", omega = between$full) %>% runmodel
cov2cor(covmat)
cormat <- cov2cor(covmat)
dat <- mvrnorm(100, rep(0, 8), cormat)
dat
mod <- ggm(dat, omega = between$full) %>% runmodel
mod <- ggm(data = dat, omega = between$full) %>% runmodel
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
cormat <- cov2cor(covmat)
dat <- mvrnorm(100, rep(0, 8), cormat)
mod <- ggm(data = dat, omega = between$full) %>% runmodel
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
cormat <- cov2cor(covmat)
dat <- mvrnorm(100, rep(0, 8), cormat)
mod <- ggm(data = dat, omega = between$full) %>% runmodel
exp(-0.29)
-0.29^10
(-0.29)^10
exp(0.29)
log(9)
exp(2.19725)
plot(ecdf(fit))
sum(pd)
mod <- ggm(data = dat, omega = between$full) %>% runmodel
pd <- vector()
fit <- vector()
for(i in 1:1000){
covmat <- crossprod(matrix(runif(8^2, 0,1), 8))
cormat <- cov2cor(covmat)
dat <- mvrnorm(100, rep(0, 8), cormat)
pd[i] <- matrixcalc::is.positive.semi.definite(covmat)
mod <- ggm(data = dat, omega = between$full) %>% runmodel
# mod <- ggm(covs = covmat, nobs = 100, covtype = "ML", omega = between$full) %>% runmodel
fit[i] <- fit(mod)[1, 2]
}
sum(pd)
fit
plot(ecdf(fit))
dat
matrixcalc::is.positive.semi.definite(covmat)
mod <- ggm(data = dat, omega = between$full) %>% runmodel
